<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>Crowd Count Dashboard</title>
Â  <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}" />
</head>
<body>
Â  
Â  <div class="dashboard">
Â  Â  <div class="sidebar">
Â  Â  Â  <h3 style="color:#ffcc00; font-weight:bold;">Dashboard</h3>
Â  Â  Â  <a href="{{ url_for('dashboard', mode='upload') }}" {% if mode == 'upload' %}class="active"{% endif %}>Image Analyze</a>
Â  Â  Â  <a href="{{ url_for('dashboard', mode='webcam') }}" {% if mode == 'webcam' %}class="active"{% endif %}>Webcam</a>
Â  Â  Â  <a href="{{ url_for('logout') }}" class="logout">Logout</a>
Â  Â  </div>
Â  Â  <div class="content">
Â  Â  Â  <h1>Welcome ðŸ‘‹ , {{ username }}</h1>


      {% if mode == 'upload' %}
      <!-- Form for View Image -->
      <form id="viewForm" method="POST" enctype="multipart/form-data" action="{{ url_for('dashboard', mode='upload') }}">
        <label for="image">Select image:</label><br />
        <input type="file" name="image" id="imageInput" accept="image/*" required /><br /><br />
        <button type="submit" name="view_image">View Image</button>

        <!-- Hidden field to keep filename for Analyze -->
        {% if stored_filename %}
          <input type="hidden" name="stored_filename" value="{{ stored_filename }}" />
        {% endif %}
      </form><br> 

      <!-- Form for Analyze Crowd -->
      <form id="analyzeForm" method="POST" action="{{ url_for('dashboard', mode='upload') }}">
        {% if stored_filename %}
          <input type="hidden" name="stored_filename" value="{{ stored_filename }}" />
          <button type="submit" name="analyse_image">Analyze Crowd</button>
        {% else %}
          <!-- Disabled button if no file selected yet -->
          <button type="button">Analyze Crowd </button>
        {% endif %}
      </form>

      {% if image_url %}
        <h4>Selected Image:</h4>
        <img src="{{ url_for('static', filename=image_url) }}" width="60%" />
      {% endif %}

      {% if output_url %}
        <img src="{{ url_for('static', filename=output_url) }}" width="70%" />
        <h3 style="margin-top:10px;">Detected People: {{ count }}</h3>
      {% endif %}

      {% elif mode == 'webcam' %}
      <h3>Live Webcam Crowd Detection</h3>
      <img src="{{ url_for('webcam_feed') }}" width="80%" />
      {% endif %}

Â  Â  </div>
Â  </div>


Â  <script>
Â  Â  const imageInput = document.getElementById('imageInput');

Â  Â  // Show chosen filename next to input
Â  Â  imageInput.addEventListener('change', () => {
Â  Â  Â  const fileName = imageInput.files.length ? imageInput.files[0].name : '';
Â  Â  Â  if(fileName) {
Â  Â  Â  Â  console.log('Selected file: ' + fileName);
Â  Â  Â  }
Â  Â  });
Â  </script>
</body>
</html>
